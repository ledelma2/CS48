--
--SQL DDL to create BikeHike database
--
--Liam Edelman, ledelma2
--UIC
--CS 480, Summer 2018
--Homework1
--

CREATE TABLE Customer (
	CID INT IDENTITY(20001, 1) PRIMARY KEY,
	FirstName NVARCHAR(128) NOT NULL,
	LastName NVARCHAR(128) NOT NULL,
	Street NVARCHAR(128),
	City NVARCHAR(40),
	_State NVARCHAR(20),
	Zip NVARCHAR(8),
	Email NVARCHAR(128) NOT NULL,
	Phone NVARCHAR(15),
	RentingOut BIT NOT NULL
);

CREATE TABLE Bike_Type (
	BTID INT IDENTITY(1, 1) PRIMARY KEY,
	_Description NVARCHAR(128) NOT NULL,
	Price FLOAT NOT NULL
);

CREATE TABLE Bike (
	BID INT IDENTITY(1001, 1) PRIMARY KEY,
	BTID INT NOT NULL FOREIGN KEY REFERENCES Bike_Type(BTID),
	YearDeployed SMALLINT NOT NULL,
	RentedOut BIT NOT NULL
);

CREATE TABLE Rentals (
	RID INT IDENTITY(1, 1) PRIMARY KEY,
	ExpectedHours FLOAT NOT NULL,
	ActualHours FLOAT,
	_Started DATETIME NOT NULL,
	Returned DATETIME,
	CID INT NOT NULL FOREIGN KEY REFERENCES Customer(CID),
	BID INT NOT NULL FOREIGN KEY REFERENCES Bike(BID)	
);

CREATE INDEX BTID_Index
ON Bike(BTID);

CREATE INDEX CID_Index
ON Rentals(CID)
INCLUDE (Returned);

CREATE INDEX BID_Index
ON Rentals(BID)
INCLUDE (Returned);